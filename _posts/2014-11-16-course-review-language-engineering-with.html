---
layout: post
title: 'Course review: Language Engineering with MPS'
date: '2014-11-16T20:00:00.000+01:00'
author: Sakis Kasampallis
tags:
- dsl
- engineering
- MPS
- implementation
- domain-specific language
- language
modified_time: '2014-11-16T21:49:45.710+01:00'
thumbnail: http://2.bp.blogspot.com/-ok0xc7r19Lo/VGjorqzg9gI/AAAAAAAAAIw/A1SfNoafxD4/s72-c/entity.png
blogger_id: tag:blogger.com,1999:blog-7146248794813174249.post-3865641708100428521
blogger_orig_url: http://sakiskasampalis.blogspot.com/2014/11/course-review-language-engineering-with.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">Last week I followed a two-day course called "Language Engineering with MPS". The course was given by <a href="http://voelter.de/">Markus Voelter</a>.<br /><br /><a href="https://www.jetbrains.com/mps/">MPS</a> is a free software (using the Apache 2.0 license) framework built on top of Intellij IDEA. Both MPS and Intellij IDEA are actively developed by JetBrains. MPS can be used for implementing Domain-Specific Languages (DSLs), usually by extending a base language which by default is Java. Extending Java is not a requirement. In fact, Markus is involved in the development of <a href="http://mbeddr.com/">mbeddr,</a> which uses a clean version of the C language as the base for targeting embedded system development.<br /><br />According to Markus textual-based language development tools such as Yacc, lex, Bison, ANTLR, and so forth are fading out because they lack support of an intelligent IDE. Although I'm not fully convinced about this statement I agree that IDE support when developing DSLs is a big plus. Do not overlook IDE support. It gives you (for free) autocompletion, a nice user interface, very readable error messages, instant deployment and debugging, and much more.<br /><br />During the course we covered only external (context-free) DSLs,  because Markus considers internal (context-sensitive) DSLs hacky, since  they usually rely on the metaprogramming features of a specific language  (Ruby, Lisp, etc.). This is most times either very limited or too  complex (for example you end up with unreadable error messages).<br /><br />Markus has a good knowledge in language design. He gave us some good tips regarding DSL development, such as forbidding Turing-completeness in the DSL to make the static analysis of a code block possible. Another tip was to support many keywords in the DSL (instead of having as few keywords as possible, which is considered good in general purpose languages like C) for giving the chance to the DSL user to provide hints  about the performance and behavior of a code block. For example provide two keywords  for <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">for</span> loops: the default <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">for</span> is (or actually tries to be) concurrent, while the alternative <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">forseq</span> is always sequential.<br /><br />Our main course activity was to use MPS for developing an Entities DSL. An Entity is an abstraction that can have a variable number of attributes with validated types. We created our own typing system for that (using Java's typing system as a basis), which supports strings and numbers. An Entity can also have references to other Entities. Finally, we can define functions inside an Entity using the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">fun</span> keyword. Here's an example of an Entity:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-ok0xc7r19Lo/VGjorqzg9gI/AAAAAAAAAIw/A1SfNoafxD4/s1600/entity.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-ok0xc7r19Lo/VGjorqzg9gI/AAAAAAAAAIw/A1SfNoafxD4/s1600/entity.png" height="167" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-EnvUEcH9CXI/VGjnMD73AkI/AAAAAAAAAIk/w_NgdkPACPs/s1600/entity.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><br /></a></div><br />Notice how we can create custom error messages for informing the DSL users when they are trying to do erroneous things such as define a variable with the same name twice. Another error reported (underlined in red on the picture) is when the user tries to return an incorrect type from a function, in this case a string from a function that should return an integer (notice the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">:number</span> part).<br /><br />From what I've seen in the course I feel that MPS is an interesting tool with the following pros and cons.<br /><br />Pros:<br /><ul style="text-align: left;"><li>Autocompletion.</li><li>Readable error messages. Even if a message is not very readable you can jump to the source code immediately using a single click.</li><li>Nice user interface.</li><li>In general it offers all the goodies of an IDE. Integrated debugging, many ways of searching, refactoring, and so forth. </li></ul>Cons:<br /><ul style="text-align: left;"><li>The DSL user (domain expert) needs to install MPS for using our DSL. This usually requires some effort, because we need to create a customized (clean) version of MPS with all development features hidden/disabled to avoid confusing the user.</li><li>Like all tools, MPS requires time and effort to feel confident with it. Especially typing in the MPS editor can be confusing and frustrating because it is very different from free-text typing which is the usual way of writing code.</li><li>Documentation. There is only one book targeting explicitly MPS so far.</li><li>Lag on Windows. The hired laptops that we used during the course were quite powerful but MPS was still lagging on Windows. I have tested it on GNU/Linux and I don't have any issues (and neither did Markus on his MacBook). It seems that MPS has performance issues on Windows.</li></ul></div>